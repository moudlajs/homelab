services:
  adguard:
    image: adguard/adguardhome:latest
    container_name: homelab_adguard
    restart: unless-stopped
    ports:
      - "3000:3000"
      - "53:53/tcp"
      - "53:53/udp"
    volumes:
      - ./data/adguard/work:/opt/adguardhome/work
      - ./data/adguard/conf:/opt/adguardhome/conf

  prometheus:
    image: prom/prometheus:latest
    container_name: homelab_prometheus
    restart: unless-stopped
    command:
      - '--config.file=/etc/prometheus/prometheus.yml'
      - '--storage.tsdb.path=/prometheus'
    ports:
      - "9090:9090"
    volumes:
      - ./data/prometheus:/prometheus
      - ./config/prometheus.yml:/etc/prometheus/prometheus.yml

  grafana:
    image: grafana/grafana:latest
    container_name: homelab_grafana
    restart: unless-stopped
    ports:
      - "3001:3000"
    environment:
      - GF_SECURITY_ADMIN_USER=admin
      - GF_SECURITY_ADMIN_PASSWORD=admin
    volumes:
      - ./data/grafana:/var/lib/grafana
    depends_on:
      - prometheus

  node-exporter:
    image: prom/node-exporter:latest
    container_name: homelab_node_exporter
    restart: unless-stopped
    ports:
      - "9100:9100"
    command:
      - '--path.procfs=/host/proc'
      - '--path.sysfs=/host/sys'
      - '--collector.filesystem.mount-points-exclude=^/(sys|proc|dev|host|etc)($$|/)'
    volumes:
      - /proc:/host/proc:ro
      - /sys:/host/sys:ro
      - /:/rootfs:ro

  ntopng:
    image: ntop/ntopng:latest
    container_name: homelab_ntopng
    restart: unless-stopped
    network_mode: host
    cap_add:
      - NET_ADMIN
    volumes:
      - ./data/ntopng:/var/lib/ntopng
    command: --community --http-port 3002 --disable-login 1

  suricata:
    image: jasonish/suricata:latest
    container_name: homelab_suricata
    restart: unless-stopped
    network_mode: host
    cap_add:
      - NET_ADMIN
      - SYS_NICE
    volumes:
      - ./data/suricata/logs:/var/log/suricata
      - ./data/suricata/rules:/var/lib/suricata/rules
      - ./config/suricata/suricata.yaml:/etc/suricata/suricata.yaml
    command: -i eth0

  scrypted:
    image: koush/scrypted:latest
    container_name: homelab_scrypted
    restart: unless-stopped
    network_mode: host
    volumes:
      - ./data/scrypted:/server/volume
    environment:
      - SCRYPTED_INSECURE_PORT=11080
